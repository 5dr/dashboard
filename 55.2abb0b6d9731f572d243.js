"use strict";(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[55],{6055:(z,d,s)=>{s.r(d),s.d(d,{PropertiesManagementModule:()=>U});var v=s(8583),p=s(3679),f=s(4284),h=s(3423),M=s(4350),y=s(5319),S=s(4295),m=s(1393),C=s(4512),b=s(5435),P=s(4395),t=s(7716),g=s(69),x=s(8966),T=s(690),w=s(5245),u=s(7322),Z=s(3157),O=s(1655);function A(r,l){if(1&r&&t._UZ(0,"img",15),2&r){const e=l.$implicit;t.Q6J("src",null==e?null:e.cover_photo,t.LSH)("alt",null==e?null:e.name)}}const D=function(){return[1,10,20,30,50]},k=function(r){return{cover_photo:r}},B=[{path:"",component:(()=>{class r{constructor(e,n,o,i){this.translateService=e,this.dialog=n,this.commonService=o,this.propertiesManagementService=i,this.propertiesCriteria={page:0,pageSize:1,status:0,property_type:0,search:""},this.propertyStatus=[{id:1,name:"Draft",displayName:"Draft"},{id:2,name:"pendingForApproval",displayName:"Pending For Approval"},{id:3,name:"published",displayName:"Published"},{id:4,name:"unlisted",displayName:"Unlisted"},{id:5,name:"blocked",displayName:"Blocked"},{id:6,name:"deleted",displayName:"Deleted"},{id:7,name:"reject",displayName:"Rejected"}],this.propertyTypes=[],this.propertiesData=[],this.columns=[{header:this.translateService.instant("propertiesManagement.propertyID"),field:"id"},{header:this.translateService.instant("propertiesManagement.propertyImg"),field:"cover_photo"},{header:this.translateService.instant("propertiesManagement.propertyName"),field:"name"},{header:this.translateService.instant("propertiesManagement.propertyType"),field:"type.property_type"},{header:this.translateService.instant("propertiesManagement.noOfGuests"),field:"no_of_guests"},{header:this.translateService.instant("propertiesManagement.noOfBedrooms"),field:"no_of_bedrooms"},{header:this.translateService.instant("propertiesManagement.noOfBathrooms"),field:"no_of_bathrooms"},{header:this.translateService.instant("propertiesManagement.country"),field:"country"},{header:this.translateService.instant("propertiesManagement.city"),field:"city"},{header:this.translateService.instant("propertiesManagement.actions"),field:"operation",width:"300px",minWidth:300,type:"button",buttons:[{color:"info",type:"icon",icon:"visibility",tooltip:this.translateService.instant("propertiesManagement.viewDetails"),click:a=>this.onViewDetails(a)},{color:"success",type:"icon",icon:"done",tooltip:this.translateService.instant("propertiesManagement.approve"),iif:a=>2===a.status,click:a=>this.onAcceptProperty(a)},{color:"warn",type:"icon",icon:"close",tooltip:this.translateService.instant("propertiesManagement.reject"),iif:a=>2===a.status,click:a=>this.onRejectProperty(a)},{color:"warn",type:"icon",icon:"lock",tooltip:this.translateService.instant("propertiesManagement.block"),iif:a=>3===a.status,click:a=>this.onBlockProperty(a)},{color:"success",type:"icon",icon:"lock_open",iif:a=>5===a.status,tooltip:this.translateService.instant("propertiesManagement.unblock"),click:a=>this.onUnBlockProperty(a)}]}],this.loading=!1,this.totalItemsCount=0,this.propertiesSearchQuery=new p.NI,this.subscriptions=new y.w}ngOnInit(){this.fetchPropertiesList(),this.fetchPropertyTypes(),this.initPropertiesSearch()}initPropertiesSearch(){this.subscriptions.add(this.propertiesSearchQuery.valueChanges.pipe((0,b.h)(e=>{var n;return(null===(n=null==e?void 0:e.trim())||void 0===n?void 0:n.length)>3||""===(null==e?void 0:e.trim())}),(0,P.b)(700)).subscribe(e=>{this.propertiesCriteria.search=e,this.propertiesCriteria.page=0,this.fetchPropertiesList()}))}fetchPropertiesList(){this.loading=!0,this.propertiesCriteria.status||delete this.propertiesCriteria.status,this.propertiesCriteria.property_type||delete this.propertiesCriteria.property_type,this.subscriptions.add(this.propertiesManagementService.fetchPropertyList(this.propertiesCriteria).subscribe(e=>{var n,o,i;this.loading=!1,this.propertiesData=null===(n=null==e?void 0:e.properties)||void 0===n?void 0:n.data,this.totalItemsCount=null===(i=null===(o=null==e?void 0:e.properties)||void 0===o?void 0:o.meta)||void 0===i?void 0:i.total},e=>{var n;this.commonService.handleErrorMessage(null===(n=null==e?void 0:e.error)||void 0===n?void 0:n.message)}))}onSelectStatus(e){this.propertiesCriteria.status=null==e?void 0:e.id,this.fetchPropertiesList()}onSelectPropertyType(e){console.log(e),e?(this.propertiesCriteria.property_type=null==e?void 0:e.id,this.fetchPropertiesList()):(this.propertiesCriteria.property_type=void 0,this.fetchPropertiesList())}fetchPropertyTypes(){this.subscriptions.add(this.propertiesManagementService.fetchPropertyTypes().subscribe(e=>{this.propertyTypes=null==e?void 0:e.data},e=>{var n;this.commonService.handleErrorMessage(null===(n=null==e?void 0:e.error)||void 0===n?void 0:n.message)}))}onViewDetails(e){const o=this.dialog.open(M.E,{disableClose:!0,width:"600px",panelClass:["main-popup"],data:{propertyData:e}}).afterClosed().subscribe(i=>{"approve"===(null==i?void 0:i.action)?this.onAcceptProperty(e):"reject"===(null==i?void 0:i.action)&&this.onRejectProperty(e),o.unsubscribe()})}onAcceptProperty(e){this.subscriptions.add(this.propertiesManagementService.updatePropertyStatus(null==e?void 0:e.uid,{status:3}).subscribe(o=>{console.log(o),this.commonService.handleSuccessMessage(this.translateService.instant("propertiesManagement.propertyAcceptSuccess"),this.translateService.instant("general.success")),this.fetchPropertiesList()},o=>{var i;this.commonService.handleErrorMessage(null===(i=null==o?void 0:o.error)||void 0===i?void 0:i.message)}))}onRejectProperty(e){const o=this.dialog.open(C.H,{disableClose:!0,width:"600px",panelClass:["main-popup"],data:{propertyData:e}}).afterClosed().subscribe(i=>{(null==i?void 0:i.isSent)&&this.fetchPropertiesList(),o.unsubscribe()})}onBlockProperty(e){const n=this.dialog.open(m.S,{disableClose:!0,width:"600px",panelClass:["main-popup"],data:{popupHeading:this.translateService.instant("general.warning"),contentMsg:this.translateService.instant("propertiesManagement.blockConfirmation"),cancelBtnText:this.translateService.instant("general.cancel"),confirmBtnText:this.translateService.instant("general.confirm")}}),o=n.componentInstance.confirmationEmitter.subscribe(i=>{i?this.blockUnblockProperty("block",e,n):n.close(),o.unsubscribe()})}onUnBlockProperty(e){const n=this.dialog.open(m.S,{disableClose:!0,width:"600px",panelClass:["main-popup"],data:{popupHeading:this.translateService.instant("general.warning"),contentMsg:this.translateService.instant("propertiesManagement.unblockConfirmation"),cancelBtnText:this.translateService.instant("general.cancel"),confirmBtnText:this.translateService.instant("general.confirm")}}),o=n.componentInstance.confirmationEmitter.subscribe(i=>{i?this.blockUnblockProperty("unblock",e,n):n.close(),o.unsubscribe()})}blockUnblockProperty(e,n,o){this.subscriptions.add(this.propertiesManagementService.updatePropertyStatus(null==n?void 0:n.uid,{status:"block"===e?5:3}).subscribe(a=>{console.log(a),o.close(),this.commonService.handleSuccessMessage(this.translateService.instant("block"===e?"propertiesManagement.propertyBlockSuccess":"propertiesManagement.propertyUnblockSuccess"),this.translateService.instant("general.success")),this.fetchPropertiesList()},a=>{var c;this.commonService.handleErrorMessage(null===(c=null==a?void 0:a.error)||void 0===c?void 0:c.message)}))}onPageChanged(e){this.propertiesCriteria.page=(null==e?void 0:e.pageIndex)-1>0?(null==e?void 0:e.pageIndex)-1:0,this.propertiesCriteria.pageSize=e.pageSize,this.fetchPropertiesList()}ngOnDestroy(){this.subscriptions.unsubscribe()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(g.sK),t.Y36(x.uw),t.Y36(T.v),t.Y36(S.T))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-properties-management"]],decls:23,vars:38,consts:[[1,"container-fluid","pt-3","pb-4"],[1,"row","title-row","pb-4"],[1,"title"],[1,"row","filter-row","pb-3"],[1,"col-lg-6","col-md-6","col-sm-12","search-container"],[1,"search-wrapper"],["matPrefix",""],["type","text",3,"formControl","placeholder"],[1,"col-lg-6","col-md-6","col-sm-12","filter-container"],["floatLabel","never",1,""],["bindLabel","displayName","bindValue","id",3,"clearable","placeholder","ngModel","items","ngModelChange","change"],["bindLabel","property_type","bindValue","id",3,"clearable","placeholder","ngModel","items","ngModelChange","change"],[1,"row","table-row"],[3,"data","columns","loading","length","columnResizable","rowSelectable","hideRowSelectionCheckbox","rowHover","rowStriped","columnMovable","expandable","showPaginator","pageSizeOptions","pageIndex","pageSize","cellTemplate","page"],["cover_photo",""],[1,"cover-photo",3,"src","alt"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h3",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.qZA(),t.TgZ(5,"div",3),t.TgZ(6,"div",4),t.TgZ(7,"div",5),t.TgZ(8,"mat-icon",6),t._uU(9,"search"),t.qZA(),t._UZ(10,"input",7),t.ALo(11,"translate"),t.qZA(),t.qZA(),t.TgZ(12,"div",8),t.TgZ(13,"mat-form-field",9),t.TgZ(14,"mtx-select",10),t.NdJ("ngModelChange",function(i){return n.propertiesCriteria.status=i})("change",function(i){return n.onSelectStatus(i)}),t.ALo(15,"translate"),t.qZA(),t.qZA(),t.TgZ(16,"mat-form-field",9),t.TgZ(17,"mtx-select",11),t.NdJ("ngModelChange",function(i){return n.propertiesCriteria.property_type=i})("change",function(i){return n.onSelectPropertyType(i)}),t.ALo(18,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(19,"div",12),t.TgZ(20,"mtx-grid",13),t.NdJ("page",function(i){return n.onPageChanged(i)}),t.qZA(),t.YNc(21,A,1,2,"ng-template",null,14,t.W1O),t.qZA(),t.qZA()),2&e){const o=t.MAs(22);t.xp6(3),t.Oqu(t.lcZ(4,27,"menu.propertiesApproval")),t.xp6(7),t.s9C("placeholder",t.lcZ(11,29,"propertiesManagement.search")),t.Q6J("formControl",n.propertiesSearchQuery),t.xp6(4),t.s9C("placeholder",t.lcZ(15,31,"propertiesManagement.propertyStatus")),t.Q6J("clearable",!0)("ngModel",n.propertiesCriteria.status)("items",n.propertyStatus),t.xp6(3),t.s9C("placeholder",t.lcZ(18,33,"propertiesManagement.propertyType")),t.Q6J("clearable",!0)("ngModel",n.propertiesCriteria.property_type)("items",n.propertyTypes),t.xp6(3),t.Q6J("data",n.propertiesData)("columns",n.columns)("loading",n.loading)("length",n.totalItemsCount)("columnResizable",!1)("rowSelectable",!1)("hideRowSelectionCheckbox",!0)("rowHover",!0)("rowStriped",!0)("columnMovable",!1)("expandable",!1)("showPaginator",!0)("pageSizeOptions",t.DdM(35,D))("pageIndex",n.propertiesCriteria.page)("pageSize",n.propertiesCriteria.pageSize)("cellTemplate",t.VKq(36,k,o))}},directives:[w.Hw,u.qo,p.Fj,p.JJ,p.oH,u.KE,Z.MS,p.On,O.CM],pipes:[g.X$],styles:[".container-fluid[_ngcontent-%COMP%]{background-color:#f4f4f4}.title-row[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{border-inline-start:6px solid var(--text-primary);color:var(--text-primary)}.search-container[_ngcontent-%COMP%]{align-self:center}.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]{background-color:#fff;padding:10px 20px;border-radius:30px;border:1px solid #CDCDCD;width:70%;overflow:hidden}@media (max-width: 1024px){.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]{width:90%}}@media (max-width: 576px){.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]{width:100%;padding:8px 10px}}.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:transparent;border:none;font-size:14px;box-shadow:none;width:90%}.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{box-shadow:none;outline:none}.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{vertical-align:middle}@media (max-width: 768px){.filter-container[_ngcontent-%COMP%]{margin-top:1em}}.filter-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:50%;display:inline-block;padding-right:1em;padding-left:1em}  .mat-button.mat-success,   .mat-icon-button.mat-success,   .mat-stroked-button.mat-success{color:green}  .mat-button.mat-info,   .mat-icon-button.mat-info,   .mat-stroked-button.mat-info{color:#56aec3}.cover-photo[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:5px;object-fit:cover}"]}),r})()}];let L=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[h.Bz.forChild(B)],h.Bz]}),r})();var R=s(5693);let U=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({providers:[],imports:[[v.ez,L,p.u5,p.UX,f.m8,R.X]]}),r})()}}]);